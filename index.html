<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mwaka Pizza - Commande & Suivi</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: sans-serif; background: #000; color: #fff; padding-bottom: 40px; }
        .nav-tabs { display: flex; background: #1a1a1a; border-bottom: 3px solid #2d5f3f; position: sticky; top: 0; z-index: 1000; }
        .nav-btn { flex: 1; padding: 15px; border: none; background: none; color: #888; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .nav-btn.active { color: #fff; background: #2d5f3f; }
        .container { max-width: 600px; margin: 0 auto; padding: 15px; }
        .section { display: none; }
        .section.active { display: block; }
        .type-selector { display: flex; gap: 10px; margin-bottom: 20px; }
        .type-btn { flex: 1; padding: 15px; border-radius: 12px; border: 2px solid #333; background: #1a1a1a; color: #888; cursor: pointer; font-weight: bold; }
        .type-btn.selected { background: #e74c3c; color: white; border-color: #e74c3c; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #2d5f3f; font-weight: bold; font-size: 0.8em; text-transform: uppercase; }
        input, textarea, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #333; background: #111; color: white; font-size: 16px; }
        .order-item { background: #111; border: 1px solid #222; padding: 12px; border-radius: 12px; margin-bottom: 10px; border-left: 5px solid #2d5f3f; position: relative; }
        .item-row { display: flex; gap: 8px; align-items: center; }
        .qty-select { width: 55px; flex: none; text-align: center; font-weight: bold; }
        .autocomplete-wrapper { position: relative; flex: 1; }
        .autocomplete-list { position: absolute; top: 100%; left: 0; width: 100%; background: #222; border: 1px solid #444; z-index: 100; max-height: 150px; overflow-y: auto; }
        .suggestion-item { padding: 10px; border-bottom: 1px solid #333; cursor: pointer; font-size: 14px; }
        .supp-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-top: 10px; }
        .supp-label { font-size: 10px; background: #222; padding: 5px; border-radius: 4px; display: flex; align-items: center; gap: 5px; }
        .supp-label input { width: auto; }
        .btn-add { width: 100%; padding: 12px; border: none; border-radius: 10px; cursor: pointer; margin: 5px 0; font-weight: bold; color: #fff; }
        .total-area { background: #1a1a1a; padding: 15px; border-radius: 12px; margin-top: 15px; border: 2px dashed #2d5f3f; text-align: center; }
        .btn-calc { background: none; border: 1px solid #2ecc71; color: #2ecc71; padding: 5px 15px; border-radius: 8px; cursor: pointer; margin-bottom: 10px; }
        .total-val { font-size: 24px; font-weight: bold; color: #2ecc71; }
        .btn-submit { width: 100%; padding: 18px; background: #e74c3c; color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 15px; cursor: pointer; }
        .delete-btn { color: #e74c3c; background: none; border: none; font-size: 11px; width: 100%; text-align: right; cursor: pointer; padding-top: 5px; }
    </style>
</head>
<body>

    <div class="nav-tabs">
        <button class="nav-btn active" onclick="showSection('orderSection', this)">Commander</button>
        <button class="nav-btn" onclick="showSection('suiviSection', this)">Suivi</button>
    </div>

    <div class="container">
        <div id="orderSection" class="section active">
            <div class="type-selector">
                <button type="button" class="type-btn" id="btnEmporter" onclick="setType('Emporter')">üè† Emporter</button>
                <button type="button" class="type-btn selected" id="btnLivraison" onclick="setType('Livraison')">üöó Livraison</button>
            </div>

            <form id="orderForm">
                <div class="form-group"><label>Nom / Pr√©nom</label><input type="text" id="clientName" required></div>
                <div id="livraisonFields">
                    <div class="form-group"><label>T√©l√©phone</label><input type="tel" id="phone"></div>
                    <div class="form-group"><label>Adresse</label><textarea id="address" rows="2"></textarea></div>
                    <div class="form-group">
                        <label>R√®glement</label>
                        <select id="paymentMethod">
                            <option value="Esp√®ces">Esp√®ces</option>
                            <option value="Carte">Carte</option>
                            <option value="Ch√®que">Ch√®que</option>
                        </select>
                    </div>
                </div>

                <label>Pizzas</label>
                <div id="pizzasList"></div>
                <button type="button" class="btn-add" style="background:#2d5f3f" onclick="addPizza()">+ PIZZA</button>
                
                <label style="margin-top:10px">Desserts & Boissons</label>
                <div id="extrasList"></div>
                <button type="button" class="btn-add" style="background:#333" onclick="addExtra()">+ DESSERT / BOISSON</button>

                <div class="total-area">
                    <button type="button" class="btn-calc" onclick="calculateTotal()">Afficher le TOTAL (‚Ç¨)</button>
                    <div>TOTAL : <span id="totalDisplay" class="total-val">0.00 ‚Ç¨</span></div>
                </div>

                <button type="submit" class="btn-submit" id="submitBtn">üöÄ ENVOYER CUISINE</button>
            </form>
        </div>
        <div id="suiviSection" class="section"><div id="suiviList"></div></div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script>
        const config = { apiKey: "AIzaSyCxyNbWyEAVot0sDzBzUdbqp4tQ2jBWMS0", authDomain: "mwakaphone-e8c5b.firebaseapp.com", projectId: "mwakaphone-e8c5b", storageBucket: "mwakaphone-e8c5b.firebasestorage.app", messagingSenderId: "258049374795", appId: "1:258049374795:web:bc7863ce2f86d8a6c8abce" };
        firebase.initializeApp(config); const db = firebase.firestore();

        let currentType = 'Livraison';
        
        // --- CATALOGUE COMPLET index (1).html ---
        const menuPizzas = [
            {n:'Maria', p:11}, {n:'Mama', p:13}, {n:'Ochan', p:14}, {n:'Salam', p:14}, {n:'Diamond', p:14},
            {n:'4 Crois√©es', p:16}, {n:'Jah', p:15}, {n:'Nossa', p:16}, {n:'Gwo Model', p:16},
            {n:'Taken', p:14}, {n:'Bad Gyal', p:15}, {n:'Poudri√®re', p:16}, {n:'Danj√©', p:17.9},
            {n:'Sir√®ne', p:17.9}, {n:'Mwaka Moon', p:15}, {n:'Ya Koi Ici', p:16}, {n:'Ou La', p:17}, {n:'Tombolo', p:17}
        ];
        const supplements = [ 
            {n:'ANANAS', p:1}, {n:'OEUF', p:1}, {n:'CREVETTES', p:4}, {n:'CREME FRAICHE', p:1},
            {n:'MERGUEZ', p:2.5}, {n:'BACON', p:2.5}, {n:'MARLIN FUME', p:4}, {n:'SAUMON FUME', p:4},
            {n:'JAMBON', p:1.5}
        ];
        const extras = [
            {n:'Glace B&J', p:8.9}, {n:'Beignet', p:2.9}, {n:'Tiramisu', p:3.9}, {n:'Muffin', p:3.9},
            {n:'Coca 50cl', p:2.5}, {n:'Coca 2L', p:5}, {n:'Fanta 50cl', p:2.5}, {n:'Chanflor 50cl', p:2}
        ];

        function setType(t) { currentType = t; document.getElementById('btnEmporter').classList.toggle('selected', t==='Emporter'); document.getElementById('btnLivraison').classList.toggle('selected', t==='Livraison'); document.getElementById('livraisonFields').style.display = t==='Livraison'?'block':'none'; }

        function addPizza() {
            const div = document.createElement('div'); div.className = 'order-item';
            div.innerHTML = `
                <div class="item-row"><select class="qty"><option>1</option><option>2</option><option>3</option></select>
                <div class="autocomplete-wrapper"><input type="text" class="name-in" placeholder="Pizza..." oninput="search(this, menuPizzas)"><div class="autocomplete-list" style="display:none"></div></div></div>
                <div class="supp-grid">${supplements.map(s=>`<label class="supp-label"><input type="checkbox" class="p-supp" data-price="${s.p}" data-name="${s.n}"> ${s.n}</label>`).join('')}</div>
                <button type="button" class="delete-btn" onclick="this.parentElement.remove()">üóëÔ∏è Supprimer</button>`;
            document.getElementById('pizzasList').appendChild(div);
        }

        function addExtra() {
            const div = document.createElement('div'); div.className = 'order-item';
            div.innerHTML = `<div class="item-row"><select class="qty"><option>1</option><option>2</option></select>
            <div class="autocomplete-wrapper"><input type="text" class="name-in" placeholder="Extra..." oninput="search(this, extras)"><div class="autocomplete-list" style="display:none"></div></div></div>
            <button type="button" class="delete-btn" onclick="this.parentElement.remove()">üóëÔ∏è Supprimer</button>`;
            document.getElementById('extrasList').appendChild(div);
        }

        function search(input, data) {
            const list = input.nextElementSibling; const val = input.value.toLowerCase();
            list.innerHTML = ""; if(!val) { list.style.display="none"; return; }
            const matches = data.filter(m => m.n.toLowerCase().includes(val));
            if(matches.length){
                list.style.display="block";
                matches.forEach(m=>{
                    const d = document.createElement('div'); d.className='suggestion-item'; d.innerText=`${m.n} (${m.p}‚Ç¨)`;
                    d.onclick=()=>{ input.value=m.n; input.dataset.price=m.p; list.style.display="none"; };
                    list.appendChild(d);
                });
            }
        }

        function calculateTotal() {
            let total = 0;
            document.querySelectorAll('.order-item').forEach(item => {
                const q = parseInt(item.querySelector('.qty').value);
                const p = parseFloat(item.querySelector('.name-in').dataset.price || 0);
                let sP = 0; item.querySelectorAll('.p-supp:checked').forEach(s => sP += parseFloat(s.dataset.price));
                total += q * (p + sP);
            });
            document.getElementById('totalDisplay').innerText = total.toFixed(2) + " ‚Ç¨";
        }

        document.getElementById('orderForm').onsubmit = async (e) => {
            e.preventDefault(); const btn = document.getElementById('submitBtn'); btn.disabled = true;
            const order = {
                clientName: document.getElementById('clientName').value,
                type: currentType.toUpperCase(), // "LIVRAISON" ou "EMPORTER"
                paymentMethod: document.getElementById('payment
