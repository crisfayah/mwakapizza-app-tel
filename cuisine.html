<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Menu Principal - Suivi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #2c3e50; color: white; padding: 20px; }
        
        .tabs-header { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { padding: 12px 25px; border: none; border-radius: 8px 8px 0 0; cursor: pointer; background: #34495e; color: white; font-weight: bold; }
        .tab-btn.active { background: #e67e22; }
        
        .tab-content { display: none; background: white; color: #333; padding: 20px; border-radius: 0 8px 8px 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .tab-content.active { display: block; }

        /* Style des lignes SUIVI */
        .suivi-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 10px;
            border-bottom: 1px solid #eee;
        }
        .suivi-item:last-child { border-bottom: none; }
        
        .id-heure { font-weight: bold; color: #2c3e50; }
        .badge-delai { background: #fff3e0; color: #e67e22; padding: 4px 10px; border-radius: 5px; font-size: 0.9rem; font-weight: 600; border: 1px solid #ffe0b2; }
        .status-label { color: #27ae60; font-weight: bold; font-size: 0.85rem; text-transform: uppercase; }
    </style>
</head>
<body>

    <div class="tabs-header">
        <button class="tab-btn" onclick="switchTab(event, 'MENU')">MENU</button>
        <button class="tab-btn active" onclick="switchTab(event, 'SUIVI_TAB')">ðŸ“‹ SUIVI</button>
    </div>

    <div id="MENU" class="tab-content">
        <h3>Votre Menu s'affiche ici.</h3>
    </div>

    <div id="SUIVI_TAB" class="tab-content active">
        <h3 style="margin-top:0;">Ã‰tat des commandes (Martinique)</h3>
        <div id="liste-suivi">
            </div>
    </div>

    <script>
        const FUSEAU_MQ = 'America/Martinique';

        function switchTab(evt, tabId) {
            let contents = document.getElementsByClassName("tab-content");
            for (let c of contents) c.classList.remove("active");
            let btns = document.getElementsByClassName("tab-btn");
            for (let b of btns) b.classList.remove("active");
            
            document.getElementById(tabId).classList.add("active");
            evt.currentTarget.classList.add("active");

            if(tabId === 'SUIVI_TAB') majAfficheSuivi();
        }

        function majAfficheSuivi() {
            const container = document.getElementById('liste-suivi');
            const maintenant = new Date();
            const aujourdhuiMQ = maintenant.toLocaleDateString('fr-FR', { timeZone: FUSEAU_MQ });

            const historique = JSON.parse(localStorage.getItem('commandes_du_jour')) || [];
            
            // On filtre pour ne garder que les commandes de la date du jour Martinique
            const commandesToday = historique.filter(cmd => cmd.date === aujourdhuiMQ);

            container.innerHTML = "";

            if (commandesToday.length === 0) {
                container.innerHTML = "<p style='color:#888;'>Aucune commande en prÃ©paration aujourd'hui.</p>";
                return;
            }

            // On affiche en commenÃ§ant par la plus rÃ©cente
            commandesToday.reverse().forEach(cmd => {
                container.innerHTML += `
                    <div class="suivi-item">
                        <div class="id-heure">
                            #${cmd.id} <span style="font-weight:normal; color:#888; margin-left:10px;">${cmd.heure}</span>
                        </div>
                        <div class="badge-delai">
                            <i class="fas fa-clock"></i> ${cmd.delai}
                        </div>
                        <div class="status-label">En prÃ©paration</div>
                    </div>
                `;
            });
        }

        // RafraÃ®chir l'affichage toutes les 15 secondes automatiquement
        setInterval(majAfficheSuivi, 15000);
        
        // Charger au lancement
        window.onload = majAfficheSuivi;
    </script>
</body>
</html>
